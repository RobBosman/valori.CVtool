= Docx templates

== Prepare a docx template

1. Open the docx file in Word and save as *docx STRICT*.
2. Expand docx content to a local directory.
3. Remove all personal text and images from the docx template, or replace with dummy text if a placeholder is needed. +
[TIP]
Regex-replace to 'flatten' an XML file: +
`\s*([ <])` => `$1`

4. Go to .../word/media/ and load + export +
`image*.emf` to `image*.png`

Regex-replace

* in all files: +
`image(\d+).emf` +
`image$1.png`
* all files: +
`image4.*` (passport photo) +
`passport.photo`
* *[Content_Types].xml*: +
`<Default Extension="emf" ContentType="image/x-emf"/>` +
`<Default Extension="photo" ContentType="application/octet-stream"/>`
* *document.xml.xsl*: +
`\s*(\w+)="\{([^}]*)}">` +
`><xsl:attribute name="$1"><xsl:value-of select="'{$2}'"/></xsl:attribute>`

Delete

* `image*.emf` +
* `image4.*` (passport photo)

Add

* `.../word/media/passport.photo` (= PNG image of a single transparent pixel)

